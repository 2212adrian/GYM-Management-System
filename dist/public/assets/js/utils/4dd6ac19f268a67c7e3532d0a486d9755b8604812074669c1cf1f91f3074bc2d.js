(function(){const a="wolf_remember_device";function i(){try{return window.localStorage.getItem(a)==="1"}catch(e){return!1}}function l(e){try{e?window.localStorage.setItem(a,"1"):window.localStorage.removeItem(a)}catch(t){}}const u={getItem(e){try{if(i()){const t=window.localStorage.getItem(e);return t!=null?t:window.sessionStorage.getItem(e)}return window.sessionStorage.getItem(e)}catch(t){return null}},setItem(e,t){try{if(i()){window.localStorage.setItem(e,t),window.sessionStorage.removeItem(e);return}window.sessionStorage.setItem(e,t),window.localStorage.removeItem(e)}catch(n){}},removeItem(e){try{window.sessionStorage.removeItem(e),window.localStorage.removeItem(e)}catch(t){}}};window.wolfAuthStorage={shouldRememberDevice:i,setRememberDevice:l};function r(e){const t=String(e||"").trim();return t.length>0&&!t.startsWith("__WOLF_SUPABASE_")}function w(){const e=window.WOLF_SUPABASE_PUBLIC_CONFIG||{},t=String(e.supabaseUrl||"").trim(),n=String(e.supabaseAnonKey||"").trim();return!r(t)||!r(n)?null:{supabaseUrl:t,supabaseAnonKey:n}}async function m(){var s;const e=await fetch("/.netlify/functions/supabase-config",{method:"GET",headers:{"Content-Type":"application/json"},cache:"no-store"});if(!e.ok){let c="";try{const o=await e.json();c=(s=o==null?void 0:o.missing)!=null&&s.length?` Missing: ${o.missing.join(", ")}`:o!=null&&o.error?` ${o.error}`:""}catch(o){}throw new Error(`Failed to load Supabase runtime config.${c}`)}const{supabaseUrl:t,supabaseAnonKey:n}=await e.json();if(!t||!n)throw new Error("Supabase runtime config is incomplete");return{supabaseUrl:t,supabaseAnonKey:n}}async function g(){const e=w(),{supabaseUrl:t,supabaseAnonKey:n}=e||await m();window.supabaseClient=supabase.createClient(t,n,{auth:{storage:u,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0},global:{headers:{apikey:n}}})}window.supabaseReady=g().then(()=>(console.log("Wolf OS: Supabase client initialized from runtime config."),window.supabaseClient)).catch(e=>(console.error("Wolf OS: Failed to initialize Supabase client.",e),null))})();
